{"version":3,"file":"cart.js","sources":["../src/cart.js"],"sourcesContent":["//Логіка сторінки Cart\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { refs } from './js/refs';\nimport { getProductsById } from './js/products-api';\nimport { showProducts, showModalProduct } from './js/render-function';\nimport { openModal } from './js/modal';\nimport { updateNavCounts } from './js/helpers';\nimport {\n  clearCart,\n  getCart,\n  isInCart,\n  isInWishlist,\n  toggleCart,\n  toggleWishlist,\n} from './js/storage';\n\nlet currentProductId = null;\n\nupdateNavCounts(refs);\ninitCart();\n\nfunction initCart() {\n  const ids = getCart();\n\n  if (!ids.length) {\n    refs.products.innerHTML = '';\n    if (refs.notFound) refs.notFound.classList.add('not-found--visible');\n    updateSummary([]);\n    return;\n  }\n\n  if (refs.notFound) refs.notFound.classList.remove('not-found--visible');\n\n  Promise.all(ids.map(id => getProductsById(id)))\n    .then(products => {\n      refs.products.innerHTML = showProducts(products);\n      updateSummary(products);\n    })\n    .catch(() => {\n      iziToast.error({ message: 'Please try again later.' });\n    });\n}\n\nfunction updateSummary(products) {\n  const items = products.length;\n  const total = products.reduce((sum, p) => sum + (Number(p.price) || 0), 0);\n\n  if (refs.cartItemsValue) refs.cartItemsValue.textContent = items;\n  if (refs.cartTotalValue) refs.cartTotalValue.textContent = `$${total}`;\n}\n\nrefs.products.addEventListener('click', event => {\n  const item = event.target.closest('.products__item');\n  if (!item) return;\n\n  const id = item.dataset.id;\n  currentProductId = id;\n\n  getProductsById(id)\n    .then(product => {\n      refs.modalProduct.innerHTML = showModalProduct(product);\n      syncModalButtons(id);\n      openModal();\n    })\n    .catch(() => {\n      iziToast.error({ message: 'Please try again later.' });\n    });\n});\n\nfunction syncModalButtons(id) {\n  refs.modalBtnWishlist.textContent = isInWishlist(id)\n    ? 'Remove from Wishlist'\n    : 'Add to Wishlist';\n\n  refs.modalBtnCart.textContent = isInCart(id)\n    ? 'Remove from Cart'\n    : 'Add to Cart';\n}\n\nrefs.modalBtnWishlist.addEventListener('click', () => {\n  if (!currentProductId) return;\n\n  toggleWishlist(currentProductId);\n  syncModalButtons(currentProductId);\n  updateNavCounts(refs);\n});\n\nrefs.modalBtnCart.addEventListener('click', () => {\n  if (!currentProductId) return;\n\n  toggleCart(currentProductId);\n  syncModalButtons(currentProductId);\n  updateNavCounts(refs);\n\n  initCart();\n});\n\nif (refs.buyBtn) {\n  refs.buyBtn.addEventListener('click', () => {\n    clearCart();\n    updateNavCounts(refs);\n    initCart();\n    iziToast.success({ message: 'Purchase successful!' });\n  });\n}\n"],"names":["currentProductId","updateNavCounts","initCart","ids","getCart","refs","updateSummary","id","getProductsById","products","showProducts","iziToast","items","total","sum","p","event","item","product","showModalProduct","syncModalButtons","openModal","isInWishlist","isInCart","toggleWishlist","toggleCart","clearCart"],"mappings":"yKAkBA,IAAIA,EAAmB,KAEvBC,EAAoB,EACpBC,IAEA,SAASA,GAAW,CAClB,MAAMC,EAAMC,IAEZ,GAAI,CAACD,EAAI,OAAQ,CACfE,EAAK,SAAS,UAAY,GACtBA,EAAK,UAAUA,EAAK,SAAS,UAAU,IAAI,oBAAoB,EACnEC,EAAc,CAAE,CAAA,EAChB,MACD,CAEGD,EAAK,UAAUA,EAAK,SAAS,UAAU,OAAO,oBAAoB,EAEtE,QAAQ,IAAIF,EAAI,IAAII,GAAMC,EAAgBD,CAAE,CAAC,CAAC,EAC3C,KAAKE,GAAY,CAChBJ,EAAK,SAAS,UAAYK,EAAaD,CAAQ,EAC/CH,EAAcG,CAAQ,CAC5B,CAAK,EACA,MAAM,IAAM,CACXE,EAAS,MAAM,CAAE,QAAS,yBAA2B,CAAA,CAC3D,CAAK,CACL,CAEA,SAASL,EAAcG,EAAU,CAC/B,MAAMG,EAAQH,EAAS,OACjBI,EAAQJ,EAAS,OAAO,CAACK,EAAKC,IAAMD,GAAO,OAAOC,EAAE,KAAK,GAAK,GAAI,CAAC,EAErEV,EAAK,iBAAgBA,EAAK,eAAe,YAAcO,GACvDP,EAAK,iBAAgBA,EAAK,eAAe,YAAc,IAAIQ,CAAK,GACtE,CAEAR,EAAK,SAAS,iBAAiB,QAASW,GAAS,CAC/C,MAAMC,EAAOD,EAAM,OAAO,QAAQ,iBAAiB,EACnD,GAAI,CAACC,EAAM,OAEX,MAAMV,EAAKU,EAAK,QAAQ,GACxBjB,EAAmBO,EAEnBC,EAAgBD,CAAE,EACf,KAAKW,GAAW,CACfb,EAAK,aAAa,UAAYc,EAAiBD,CAAO,EACtDE,EAAiBb,CAAE,EACnBc,GACN,CAAK,EACA,MAAM,IAAM,CACXV,EAAS,MAAM,CAAE,QAAS,yBAA2B,CAAA,CAC3D,CAAK,CACL,CAAC,EAED,SAASS,EAAiBb,EAAI,CAC5BF,EAAK,iBAAiB,YAAciB,EAAaf,CAAE,EAC/C,uBACA,kBAEJF,EAAK,aAAa,YAAckB,EAAShB,CAAE,EACvC,mBACA,aACN,CAEAF,EAAK,iBAAiB,iBAAiB,QAAS,IAAM,CAC/CL,IAELwB,EAAexB,CAAgB,EAC/BoB,EAAiBpB,CAAgB,EACjCC,EAAoB,EACtB,CAAC,EAEDI,EAAK,aAAa,iBAAiB,QAAS,IAAM,CAC3CL,IAELyB,EAAWzB,CAAgB,EAC3BoB,EAAiBpB,CAAgB,EACjCC,EAAoB,EAEpBC,IACF,CAAC,EAEGG,EAAK,QACPA,EAAK,OAAO,iBAAiB,QAAS,IAAM,CAC1CqB,IACAzB,EAAoB,EACpBC,IACAS,EAAS,QAAQ,CAAE,QAAS,sBAAwB,CAAA,CACxD,CAAG"}