{"version":3,"file":"index.js","sources":["../src/home.js"],"sourcesContent":["//Логіка сторінки Home\nimport {\n  getCategorys,\n  getProductsByCategory,\n  getProductsById,\n} from './js/products-api';\nimport { refs } from './js/refs';\nimport { showProducts, showModalProduct } from './js/render-function';\nimport { openModal } from './js/modal';\nimport { updateNavCounts } from './js/helpers';\nimport {\n  isInCart,\n  isInWishlist,\n  toggleCart,\n  toggleWishlist,\n} from './js/storage';\n\nlet currentPage = 1;\nlet currentCategory = 'All';\nlet currentProductId = null;\n\nupdateNavCounts(refs);\n\ngetCategorys()\n  .then(data => {\n    const categoryArray = ['All', ...data];\n\n    const markup = categoryArray\n      .map(\n        category => `\n        <li class=\"categories__item\">\n          <button class=\"categories__btn\" type=\"button\">${category}</button>\n        </li>`\n      )\n      .join('');\n\n    refs.categories.innerHTML = markup;\n\n    const firstBtn = refs.categories.querySelector('.categories__btn');\n    if (firstBtn) firstBtn.classList.add('categories__btn--active');\n  })\n  .catch(err => console.log(err));\n\nrefs.categories.addEventListener('click', event => {\n  const button = event.target.closest('button.categories__btn');\n  if (!button) return;\n\n  const prevActive = refs.categories.querySelector('.categories__btn--active');\n  if (prevActive) prevActive.classList.remove('categories__btn--active');\n\n  button.classList.add('categories__btn--active');\n\n  currentCategory = button.textContent.trim();\n  loadProducts(true);\n});\n\nfunction loadProducts(reset = false) {\n  if (reset) {\n    currentPage = 1;\n    refs.products.innerHTML = '';\n  }\n\n  getProductsByCategory(currentCategory, currentPage)\n    .then(data => {\n      const markup = showProducts(data.products);\n\n      if (reset) {\n        refs.products.innerHTML = markup;\n      } else {\n        refs.products.insertAdjacentHTML('beforeend', markup);\n      }\n\n      const loaded = refs.products.querySelectorAll('.products__item').length;\n\n      if (loaded >= data.total) {\n        refs.loadMoreBtn.classList.add('is-hidden');\n      } else {\n        refs.loadMoreBtn.classList.remove('is-hidden');\n\n        if (refs.notFound) {\n          if (!data.products || data.products.length === 0)\n            refs.notFound.classList.add('not-found--visible');\n          else refs.notFound.classList.remove('not-found--visible');\n        }\n      }\n    })\n    .catch(err => console.log(err));\n}\n\nloadProducts(true);\n\nrefs.loadMoreBtn.addEventListener('click', () => {\n  currentPage += 1;\n  loadProducts(false);\n});\n\nrefs.products.addEventListener('click', event => {\n  const item = event.target.closest('.products__item');\n  if (!item) return;\n\n  const id = item.dataset.id;\n  currentProductId = id;\n\n  getProductsById(id)\n    .then(product => {\n      refs.modalProduct.innerHTML = showModalProduct(product);\n      openModal();\n    })\n    .catch(error => console.log(error));\n});\n\nfunction syncModalButtons(id) {\n  if (!refs.modalBtnWishlist || !refs.modalBtnCart) return;\n\n  refs.modalBtnWishlist.textContent = isInWishlist(id)\n    ? 'Remove from Wishlist'\n    : 'Add to Wishlist';\n\n  refs.modalBtnCart.textContent = isInCart(id)\n    ? 'Remove from Cart'\n    : 'Add to Cart';\n}\n\nrefs.modalBtnWishlist.addEventListener('click', () => {\n  if (!currentProductId) return;\n  toggleWishlist(currentProductId);\n  syncModalButtons(currentProductId);\n  updateNavCounts(refs);\n});\n\nrefs.modalBtnCart.addEventListener('click', () => {\n  if (!currentProductId) return;\n  toggleCart(currentProductId);\n  syncModalButtons(currentProductId);\n  updateNavCounts(refs);\n});\n"],"names":["currentPage","currentCategory","currentProductId","updateNavCounts","getCategorys","data","markup","category","refs","firstBtn","err","event","button","prevActive","loadProducts","reset","getProductsByCategory","showProducts","item","id","getProductsById","product","showModalProduct","openModal","error","syncModalButtons","isInWishlist","isInCart","toggleWishlist","toggleCart"],"mappings":"6JAiBA,IAAIA,EAAc,EACdC,EAAkB,MAClBC,EAAmB,KAEvBC,EAAoB,EAEpBC,EAAc,EACX,KAAKC,GAAQ,CAGZ,MAAMC,EAFgB,CAAC,MAAO,GAAGD,CAAI,EAGlC,IACCE,GAAY;AAAA;AAAA,0DAEsCA,CAAQ;AAAA,cAE3D,EACA,KAAK,EAAE,EAEVC,EAAK,WAAW,UAAYF,EAE5B,MAAMG,EAAWD,EAAK,WAAW,cAAc,kBAAkB,EAC7DC,GAAUA,EAAS,UAAU,IAAI,yBAAyB,CAClE,CAAG,EACA,MAAMC,GAAO,QAAQ,IAAIA,CAAG,CAAC,EAEhCF,EAAK,WAAW,iBAAiB,QAASG,GAAS,CACjD,MAAMC,EAASD,EAAM,OAAO,QAAQ,wBAAwB,EAC5D,GAAI,CAACC,EAAQ,OAEb,MAAMC,EAAaL,EAAK,WAAW,cAAc,0BAA0B,EACvEK,GAAYA,EAAW,UAAU,OAAO,yBAAyB,EAErED,EAAO,UAAU,IAAI,yBAAyB,EAE9CX,EAAkBW,EAAO,YAAY,OACrCE,EAAa,EAAI,CACnB,CAAC,EAED,SAASA,EAAaC,EAAQ,GAAO,CAC/BA,IACFf,EAAc,EACdQ,EAAK,SAAS,UAAY,IAG5BQ,EAAsBf,EAAiBD,CAAW,EAC/C,KAAKK,GAAQ,CACZ,MAAMC,EAASW,EAAaZ,EAAK,QAAQ,EAErCU,EACFP,EAAK,SAAS,UAAYF,EAE1BE,EAAK,SAAS,mBAAmB,YAAaF,CAAM,EAGvCE,EAAK,SAAS,iBAAiB,iBAAiB,EAAE,QAEnDH,EAAK,MACjBG,EAAK,YAAY,UAAU,IAAI,WAAW,GAE1CA,EAAK,YAAY,UAAU,OAAO,WAAW,EAEzCA,EAAK,WACH,CAACH,EAAK,UAAYA,EAAK,SAAS,SAAW,EAC7CG,EAAK,SAAS,UAAU,IAAI,oBAAoB,EAC7CA,EAAK,SAAS,UAAU,OAAO,oBAAoB,GAGlE,CAAK,EACA,MAAME,GAAO,QAAQ,IAAIA,CAAG,CAAC,CAClC,CAEAI,EAAa,EAAI,EAEjBN,EAAK,YAAY,iBAAiB,QAAS,IAAM,CAC/CR,GAAe,EACfc,EAAa,EAAK,CACpB,CAAC,EAEDN,EAAK,SAAS,iBAAiB,QAASG,GAAS,CAC/C,MAAMO,EAAOP,EAAM,OAAO,QAAQ,iBAAiB,EACnD,GAAI,CAACO,EAAM,OAEX,MAAMC,EAAKD,EAAK,QAAQ,GACxBhB,EAAmBiB,EAEnBC,EAAgBD,CAAE,EACf,KAAKE,GAAW,CACfb,EAAK,aAAa,UAAYc,EAAiBD,CAAO,EACtDE,GACN,CAAK,EACA,MAAMC,GAAS,QAAQ,IAAIA,CAAK,CAAC,CACtC,CAAC,EAED,SAASC,EAAiBN,EAAI,CACxB,CAACX,EAAK,kBAAoB,CAACA,EAAK,eAEpCA,EAAK,iBAAiB,YAAckB,EAAaP,CAAE,EAC/C,uBACA,kBAEJX,EAAK,aAAa,YAAcmB,EAASR,CAAE,EACvC,mBACA,cACN,CAEAX,EAAK,iBAAiB,iBAAiB,QAAS,IAAM,CAC/CN,IACL0B,EAAe1B,CAAgB,EAC/BuB,EAAiBvB,CAAgB,EACjCC,EAAoB,EACtB,CAAC,EAEDK,EAAK,aAAa,iBAAiB,QAAS,IAAM,CAC3CN,IACL2B,EAAW3B,CAAgB,EAC3BuB,EAAiBvB,CAAgB,EACjCC,EAAoB,EACtB,CAAC"}